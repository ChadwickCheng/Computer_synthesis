<!-- 
å…³ç³»ä»£æ•°è¿ç®—ç¬¦å­¦ä¹ ç¬”è®°
1. æ¦‚å¿µï¼šç”¨å¯¹å…³ç³»çš„è¿ç®—è¡¨è¾¾æŸ¥è¯¢
2. é€‰æ‹©ï¼šÏƒï¼Œé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„è¡Œ
3. æŠ•å½±ï¼šÏ€ï¼Œé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„åˆ—ï¼Œè‡ªåŠ¨å»é‡
4. ç¬›å¡å°”ç§¯ï¼šÃ—ï¼Œè¿æ¥ä¸¤ä¸ªå…³ç³»çš„æ¯ä¸€è¡Œ
5. è¿æ¥ï¼šâ¨ï¼Œæ ¹æ®æ¡ä»¶ç­›é€‰ç¬›å¡å°”ç§¯
6. è‡ªç„¶è¿æ¥ï¼šå…ˆç­‰å€¼è¿æ¥ï¼Œå†å»é™¤é‡å¤åˆ—
7. å·¦å¤–è¿æ¥ï¼šå…ˆè‡ªç„¶è¿æ¥ï¼Œä¿ç•™å·¦è¡¨æ‰€æœ‰è¡Œï¼Œå³è¡¨æ— åŒ¹é…ç”¨null
8. å³å¤–è¿æ¥ï¼šä¿ç•™å³è¡¨æ‰€æœ‰è¡Œ
9. å¤–è¿æ¥ï¼šå·¦å³éƒ½ä¿ç•™
10. é™¤å·ï¼šN1Ã·N2ï¼Œå“ªäº›N1çš„AåŒæ—¶æœ‰N2çš„Bï¼Œé‡åˆ°æ‰€æœ‰å…¨éƒ¨è‡³å°‘å°±ç”¨é™¤å·
11. åˆ—å¯ä»¥ç”¨åˆ—åå’Œæ•°å­—æ ‡è¯† 
-->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…³ç³»ä»£æ•°è¿ç®—ç¤ºä¾‹</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        h2 {
            color: #4CAF50;
            margin-top: 30px;
            border-left: 5px solid #4CAF50;
            padding-left: 10px;
        }
        .section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .formula {
            background: #e8f5e9;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #4CAF50;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
        }
        .explanation {
            color: #666;
            font-style: italic;
            margin: 10px 0;
            padding: 10px;
            background: #fff3e0;
            border-left: 4px solid #ff9800;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        th {
            background-color: #4CAF50;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tr:hover {
            background-color: #e8f5e9;
        }
        .result-title {
            font-weight: bold;
            color: #1976d2;
            margin-top: 15px;
            font-size: 18px;
        }
        .table-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        .table-wrapper {
            flex: 1;
            min-width: 300px;
        }
        .table-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
            background: #e3f2fd;
            padding: 8px;
            border-radius: 4px;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .highlight {
            background-color: #ffeb3b !important;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>ğŸ“š å…³ç³»ä»£æ•°è¿ç®—ç¬¦è¯¦è§£ä¸ç¤ºä¾‹</h1>

    <!-- åŸºç¡€è¡¨æ•°æ® -->
    <div class="section">
        <h2>ğŸ—‚ï¸ åŸºç¡€æ•°æ®è¡¨</h2>
        <div class="table-container">
            <div class="table-wrapper">
                <div class="table-name">å­¦ç”Ÿè¡¨ (Student)</div>
                <table id="studentTable"></table>
            </div>
            <div class="table-wrapper">
                <div class="table-name">è¯¾ç¨‹è¡¨ (Course)</div>
                <table id="courseTable"></table>
            </div>
        </div>
        <div class="table-wrapper">
            <div class="table-name">é€‰è¯¾è¡¨ (SC - Student Course)</div>
            <table id="scTable"></table>
        </div>
    </div>

    <!-- 1. é€‰æ‹©è¿ç®— -->
    <div class="section">
        <h2>1ï¸âƒ£ é€‰æ‹© (Selection) - Ïƒ</h2>
        <div class="formula">Ïƒ<sub>Ageâ‰¥20</sub>(Student)</div>
        <div class="explanation">ğŸ’¡ é€‰æ‹©å¹´é¾„â‰¥20çš„å­¦ç”Ÿï¼ˆé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„<strong>è¡Œ</strong>ï¼‰</div>
        <button onclick="showSelection()">æ‰§è¡Œé€‰æ‹©è¿ç®—</button>
        <div id="selectionResult"></div>
    </div>

    <!-- 2. æŠ•å½±è¿ç®— -->
    <div class="section">
        <h2>2ï¸âƒ£ æŠ•å½± (Projection) - Ï€</h2>
        <div class="formula">Ï€<sub>Sname, Age</sub>(Student)</div>
        <div class="explanation">ğŸ’¡ æŠ•å½±å‡ºå­¦ç”Ÿçš„å§“åå’Œå¹´é¾„ï¼ˆé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„<strong>åˆ—</strong>ï¼Œè‡ªåŠ¨å»é‡ï¼‰</div>
        <button onclick="showProjection()">æ‰§è¡ŒæŠ•å½±è¿ç®—</button>
        <div id="projectionResult"></div>
    </div>

    <!-- 3. ç¬›å¡å°”ç§¯ -->
    <div class="section">
        <h2>3ï¸âƒ£ ç¬›å¡å°”ç§¯ (Cartesian Product) - Ã—</h2>
        <div class="formula">Student Ã— Course</div>
        <div class="explanation">ğŸ’¡ è¿æ¥ä¸¤ä¸ªå…³ç³»çš„æ¯ä¸€è¡Œï¼ˆmè¡ŒÃ—nè¡Œ = mÃ—nè¡Œï¼‰- ç»“æœè¾ƒå¤§ï¼Œä»…æ˜¾ç¤ºéƒ¨åˆ†</div>
        <button onclick="showCartesian()">æ‰§è¡Œç¬›å¡å°”ç§¯</button>
        <div id="cartesianResult"></div>
    </div>

    <!-- 4. è¿æ¥è¿ç®— -->
    <div class="section">
        <h2>4ï¸âƒ£ è¿æ¥ (Join) - â¨</h2>
        <div class="formula">Student â¨<sub>Student.Sno=SC.Sno</sub> SC</div>
        <div class="explanation">ğŸ’¡ æ ¹æ®æ¡ä»¶ç­›é€‰ç¬›å¡å°”ç§¯ï¼ˆåªä¿ç•™å­¦å·ç›¸ç­‰çš„è¡Œï¼‰</div>
        <button onclick="showJoin()">æ‰§è¡Œè¿æ¥è¿ç®—</button>
        <div id="joinResult"></div>
    </div>

    <!-- 5. è‡ªç„¶è¿æ¥ -->
    <div class="section">
        <h2>5ï¸âƒ£ è‡ªç„¶è¿æ¥ (Natural Join) - â¨</h2>
        <div class="formula">Student â¨ SC</div>
        <div class="explanation">ğŸ’¡ å…ˆç­‰å€¼è¿æ¥ï¼ˆç›¸åŒåˆ—åè‡ªåŠ¨åŒ¹é…ï¼‰ï¼Œå†å»é™¤é‡å¤åˆ—</div>
        <button onclick="showNaturalJoin()">æ‰§è¡Œè‡ªç„¶è¿æ¥</button>
        <div id="naturalJoinResult"></div>
    </div>

    <!-- 6. å·¦å¤–è¿æ¥ -->
    <div class="section">
        <h2>6ï¸âƒ£ å·¦å¤–è¿æ¥ (Left Outer Join) - âŸ•</h2>
        <div class="formula">Student âŸ• SC</div>
        <div class="explanation">ğŸ’¡ å…ˆè‡ªç„¶è¿æ¥ï¼Œä¿ç•™å·¦è¡¨(Student)æ‰€æœ‰è¡Œï¼Œå³è¡¨æ— åŒ¹é…ç”¨NULLå¡«å……</div>
        <button onclick="showLeftJoin()">æ‰§è¡Œå·¦å¤–è¿æ¥</button>
        <div id="leftJoinResult"></div>
    </div>

    <!-- 7. å³å¤–è¿æ¥ -->
    <div class="section">
        <h2>7ï¸âƒ£ å³å¤–è¿æ¥ (Right Outer Join) - âŸ–</h2>
        <div class="formula">Student âŸ– SC</div>
        <div class="explanation">ğŸ’¡ å…ˆè‡ªç„¶è¿æ¥ï¼Œä¿ç•™å³è¡¨(SC)æ‰€æœ‰è¡Œï¼Œå·¦è¡¨æ— åŒ¹é…ç”¨NULLå¡«å……</div>
        <button onclick="showRightJoin()">æ‰§è¡Œå³å¤–è¿æ¥</button>
        <div id="rightJoinResult"></div>
    </div>

    <!-- 8. å…¨å¤–è¿æ¥ -->
    <div class="section">
        <h2>8ï¸âƒ£ å…¨å¤–è¿æ¥ (Full Outer Join) - âŸ—</h2>
        <div class="formula">Student âŸ— SC</div>
        <div class="explanation">ğŸ’¡ å·¦å³è¡¨éƒ½ä¿ç•™ï¼Œæ— åŒ¹é…çš„ç”¨NULLå¡«å……</div>
        <button onclick="showFullJoin()">æ‰§è¡Œå…¨å¤–è¿æ¥</button>
        <div id="fullJoinResult"></div>
    </div>

    <!-- 9. é™¤æ³•è¿ç®— -->
    <div class="section">
        <h2>9ï¸âƒ£ é™¤æ³• (Division) - Ã·</h2>
        <div class="formula">SC Ã· Course</div>
        <div class="explanation">ğŸ’¡ æŸ¥è¯¢é€‰ä¿®äº†<strong>æ‰€æœ‰</strong>è¯¾ç¨‹çš„å­¦ç”Ÿï¼ˆé‡åˆ°"æ‰€æœ‰"ã€"å…¨éƒ¨"ã€"è‡³å°‘"å°±ç”¨é™¤å·ï¼‰</div>
        <div class="explanation">ğŸ“– SC Ã· Course = å“ªäº›å­¦ç”Ÿ(Sno)çš„è¯¾ç¨‹å·(Cno)åŒ…å«äº†Courseè¡¨ä¸­çš„æ‰€æœ‰è¯¾ç¨‹</div>
        <button onclick="showDivision()">æ‰§è¡Œé™¤æ³•è¿ç®—</button>
        <div id="divisionResult"></div>
    </div>

    <script>
        // åŸºç¡€æ•°æ®
        const students = [
            {Sno: 'S01', Sname: 'å¼ ä¸‰', Age: 19, Sex: 'ç”·'},
            {Sno: 'S02', Sname: 'æå››', Age: 20, Sex: 'å¥³'},
            {Sno: 'S03', Sname: 'ç‹äº”', Age: 22, Sex: 'ç”·'},
            {Sno: 'S04', Sname: 'èµµå…­', Age: 21, Sex: 'å¥³'},
            {Sno: 'S05', Sname: 'å­™ä¸ƒ', Age: 19, Sex: 'ç”·'}
        ];

        const courses = [
            {Cno: 'C01', Cname: 'æ•°æ®åº“', Credit: 4},
            {Cno: 'C02', Cname: 'æ•°æ®ç»“æ„', Credit: 3},
            {Cno: 'C03', Cname: 'æ“ä½œç³»ç»Ÿ', Credit: 4}
        ];

        const sc = [
            {Sno: 'S01', Cno: 'C01', Grade: 85},
            {Sno: 'S01', Cno: 'C02', Grade: 90},
            {Sno: 'S02', Cno: 'C01', Grade: 88},
            {Sno: 'S02', Cno: 'C02', Grade: 92},
            {Sno: 'S02', Cno: 'C03', Grade: 87},
            {Sno: 'S03', Cno: 'C01', Grade: 78},
            {Sno: 'S04', Cno: 'C02', Grade: 95}
        ];

        // æ¸²æŸ“è¡¨æ ¼
        function renderTable(data, elementId) {
            if (data.length === 0) {
                document.getElementById(elementId).innerHTML = '<p>ç»“æœä¸ºç©º</p>';
                return;
            }
            
            const keys = Object.keys(data[0]);
            let html = '<tr>';
            keys.forEach(key => {
                html += `<th>${key}</th>`;
            });
            html += '</tr>';
            
            data.forEach(row => {
                html += '<tr>';
                keys.forEach(key => {
                    html += `<td>${row[key] === null ? 'NULL' : row[key]}</td>`;
                });
                html += '</tr>';
            });
            
            document.getElementById(elementId).innerHTML = html;
        }

        // æ¸²æŸ“å¸¦æ ‡é¢˜çš„ç»“æœ
        function renderResult(containerId, data, title = 'ç»“æœ') {
            const container = document.getElementById(containerId);
            container.innerHTML = `
                <div class="result-title">ğŸ“Š ${title}ï¼ˆå…± ${data.length} è¡Œï¼‰</div>
                <table id="${containerId}_table"></table>
            `;
            renderTable(data, `${containerId}_table`);
        }

        // åˆå§‹åŒ–æ˜¾ç¤ºåŸºç¡€è¡¨
        renderTable(students, 'studentTable');
        renderTable(courses, 'courseTable');
        renderTable(sc, 'scTable');

        // 1. é€‰æ‹©è¿ç®—
        function showSelection() {
            const result = students.filter(s => s.Age >= 20);
            renderResult('selectionResult', result, 'é€‰æ‹© Ageâ‰¥20 çš„å­¦ç”Ÿ');
        }

        // 2. æŠ•å½±è¿ç®—
        function showProjection() {
            const result = students.map(s => ({
                Sname: s.Sname,
                Age: s.Age
            }));
            // å»é‡
            const unique = Array.from(new Map(result.map(item => 
                [JSON.stringify(item), item])).values());
            renderResult('projectionResult', unique, 'æŠ•å½± Sname, Age');
        }

        // 3. ç¬›å¡å°”ç§¯
        function showCartesian() {
            const result = [];
            students.forEach(s => {
                courses.forEach(c => {
                    result.push({...s, ...c});
                });
            });
            // åªæ˜¾ç¤ºå‰10è¡Œ
            renderResult('cartesianResult', result.slice(0, 10), 
                `ç¬›å¡å°”ç§¯ï¼ˆæ€»å…± ${result.length} è¡Œï¼Œä»…æ˜¾ç¤ºå‰10è¡Œï¼‰`);
        }

        // 4. è¿æ¥è¿ç®—
        function showJoin() {
            const result = [];
            students.forEach(s => {
                sc.forEach(sc_row => {
                    if (s.Sno === sc_row.Sno) {
                        result.push({
                            Sno: s.Sno,
                            Sname: s.Sname,
                            Age: s.Age,
                            Sex: s.Sex,
                            Cno: sc_row.Cno,
                            Grade: sc_row.Grade
                        });
                    }
                });
            });
            renderResult('joinResult', result, 'è¿æ¥ Student.Sno = SC.Sno');
        }

        // 5. è‡ªç„¶è¿æ¥
        function showNaturalJoin() {
            const result = [];
            students.forEach(s => {
                sc.forEach(sc_row => {
                    if (s.Sno === sc_row.Sno) {
                        result.push({
                            Sno: s.Sno,  // å»é‡ï¼šåªä¿ç•™ä¸€ä¸ªSno
                            Sname: s.Sname,
                            Age: s.Age,
                            Sex: s.Sex,
                            Cno: sc_row.Cno,
                            Grade: sc_row.Grade
                        });
                    }
                });
            });
            renderResult('naturalJoinResult', result, 'è‡ªç„¶è¿æ¥ï¼ˆè‡ªåŠ¨åŒ¹é…Snoå¹¶å»é‡ï¼‰');
        }

        // 6. å·¦å¤–è¿æ¥
        function showLeftJoin() {
            const result = [];
            students.forEach(s => {
                const matches = sc.filter(sc_row => sc_row.Sno === s.Sno);
                if (matches.length > 0) {
                    matches.forEach(sc_row => {
                        result.push({
                            Sno: s.Sno,
                            Sname: s.Sname,
                            Age: s.Age,
                            Sex: s.Sex,
                            Cno: sc_row.Cno,
                            Grade: sc_row.Grade
                        });
                    });
                } else {
                    // æ²¡æœ‰åŒ¹é…ï¼Œå³è¡¨ç”¨NULL
                    result.push({
                        Sno: s.Sno,
                        Sname: s.Sname,
                        Age: s.Age,
                        Sex: s.Sex,
                        Cno: null,
                        Grade: null
                    });
                }
            });
            renderResult('leftJoinResult', result, 'å·¦å¤–è¿æ¥ï¼ˆä¿ç•™æ‰€æœ‰å­¦ç”Ÿï¼‰');
        }

        // 7. å³å¤–è¿æ¥
        function showRightJoin() {
            const result = [];
            const matchedSnos = new Set();
            
            sc.forEach(sc_row => {
                const student = students.find(s => s.Sno === sc_row.Sno);
                if (student) {
                    matchedSnos.add(sc_row.Sno);
                    result.push({
                        Sno: student.Sno,
                        Sname: student.Sname,
                        Age: student.Age,
                        Sex: student.Sex,
                        Cno: sc_row.Cno,
                        Grade: sc_row.Grade
                    });
                } else {
                    result.push({
                        Sno: sc_row.Sno,
                        Sname: null,
                        Age: null,
                        Sex: null,
                        Cno: sc_row.Cno,
                        Grade: sc_row.Grade
                    });
                }
            });
            renderResult('rightJoinResult', result, 'å³å¤–è¿æ¥ï¼ˆä¿ç•™æ‰€æœ‰é€‰è¯¾è®°å½•ï¼‰');
        }

        // 8. å…¨å¤–è¿æ¥
        function showFullJoin() {
            const result = [];
            const matchedSnos = new Set();
            
            // å…ˆå¤„ç†åŒ¹é…çš„
            students.forEach(s => {
                const matches = sc.filter(sc_row => sc_row.Sno === s.Sno);
                if (matches.length > 0) {
                    matchedSnos.add(s.Sno);
                    matches.forEach(sc_row => {
                        result.push({
                            Sno: s.Sno,
                            Sname: s.Sname,
                            Age: s.Age,
                            Sex: s.Sex,
                            Cno: sc_row.Cno,
                            Grade: sc_row.Grade
                        });
                    });
                } else {
                    // å·¦è¡¨æ²¡åŒ¹é…çš„
                    result.push({
                        Sno: s.Sno,
                        Sname: s.Sname,
                        Age: s.Age,
                        Sex: s.Sex,
                        Cno: null,
                        Grade: null
                    });
                }
            });
            
            // å³è¡¨æ²¡åŒ¹é…çš„ï¼ˆè¿™ä¸ªä¾‹å­ä¸­ä¸å­˜åœ¨ï¼‰
            sc.forEach(sc_row => {
                if (!matchedSnos.has(sc_row.Sno)) {
                    result.push({
                        Sno: sc_row.Sno,
                        Sname: null,
                        Age: null,
                        Sex: null,
                        Cno: sc_row.Cno,
                        Grade: sc_row.Grade
                    });
                }
            });
            
            renderResult('fullJoinResult', result, 'å…¨å¤–è¿æ¥ï¼ˆä¿ç•™æ‰€æœ‰è®°å½•ï¼‰');
        }

        // 9. é™¤æ³•è¿ç®—
        function showDivision() {
            // SC Ã· Courseï¼šæ‰¾å‡ºé€‰ä¿®äº†æ‰€æœ‰è¯¾ç¨‹çš„å­¦ç”Ÿ
            const allCourses = courses.map(c => c.Cno);
            const studentCourses = {};
            
            // ç»Ÿè®¡æ¯ä¸ªå­¦ç”Ÿé€‰äº†å“ªäº›è¯¾
            sc.forEach(sc_row => {
                if (!studentCourses[sc_row.Sno]) {
                    studentCourses[sc_row.Sno] = [];
                }
                studentCourses[sc_row.Sno].push(sc_row.Cno);
            });
            
            // æ‰¾å‡ºé€‰äº†æ‰€æœ‰è¯¾ç¨‹çš„å­¦ç”Ÿ
            const result = [];
            Object.keys(studentCourses).forEach(sno => {
                const hasAllCourses = allCourses.every(cno => 
                    studentCourses[sno].includes(cno)
                );
                if (hasAllCourses) {
                    const student = students.find(s => s.Sno === sno);
                    result.push({
                        Sno: sno,
                        Sname: student ? student.Sname : 'Unknown'
                    });
                }
            });
            
            const container = document.getElementById('divisionResult');
            container.innerHTML = `
                <div class="result-title">ğŸ“Š é€‰ä¿®äº†æ‰€æœ‰è¯¾ç¨‹çš„å­¦ç”Ÿï¼ˆå…± ${result.length} äººï¼‰</div>
                ${result.length > 0 ? 
                    `<table id="divisionResult_table"></table>` : 
                    '<p style="color: #f44336; padding: 15px; background: #ffebee;">æ²¡æœ‰å­¦ç”Ÿé€‰ä¿®äº†æ‰€æœ‰è¯¾ç¨‹</p>'}
            `;
            if (result.length > 0) {
                renderTable(result, 'divisionResult_table');
            }
        }
    </script>
</body>
</html>